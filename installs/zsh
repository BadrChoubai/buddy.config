#!/usr/bin/env bash
set -euo pipefail

if ! command -v zsh &> /dev/null; then
    echo "Installing Zsh..."
    sudo apt update
    sudo apt install -y zsh
else
    echo "Zsh already installed, skipping."
fi

current_shell=$(getent passwd "$USER" | cut -d: -f7)
zsh_path=$(command -v zsh)

if [[ "$current_shell" != "$zsh_path" ]]; then
    echo "Changing default shell to Zsh..."
    sudo chsh -s "$zsh_path" "$USER"
else
    echo "Default shell already Zsh, skipping."
fi

if [[ ! -d "$HOME/.oh-my-zsh" ]]; then
    echo "Installing Oh My Zsh..."
    RUNZSH=no sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
else
    echo "Oh My Zsh already installed, skipping."
fi

